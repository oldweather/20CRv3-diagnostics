
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Validation Spread v. Error plot January 1872 + Spring 1903 + February 1953 &#8212; Tests and analyses of version 3 of the Twentieth Century Reanalysis</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Authors and acknowledgements" href="../credits.html" />
    <link rel="prev" title="Validation Spread v. Error plot February 1953" href="February_1953/comparison.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="../credits.html" title="Authors and acknowledgements"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="February_1953/comparison.html" title="Validation Spread v. Error plot February 1953"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">20CRv3</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/t2t3.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../instructions.html">How to use this</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tropical-storms/tropical_storms.html">Tropical Storms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../european_windstorms/european_windstorms.html">European windstorms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extreme_months/extreme_months.html">Extreme months</a></li>
<li class="toctree-l1"><a class="reference internal" href="../north_american_severe_weather/nasw.html">North American severe weather</a></li>
<li class="toctree-l1"><a class="reference internal" href="../australian_east_coast_lows/aecl.html">Australian east coast lows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cold_surges/cold_surges.html">Cold Surges</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="January_1872/january_1872.html">Validation against observations for January 1872</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spring_1903/spring_1903.html">Validation against observations for Spring 1903</a></li>
<li class="toctree-l1"><a class="reference internal" href="February_1953/february_1953.html">Validation against observations for February 1953</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Validation Spread v. Error plot January 1872 + Spring 1903 + February 1953</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Authors and acknowledgements</a></li>
</ul>
<h3><a href="https://github.com/oldweather/20CRv3-diagnostics">Get a copy</a></h3>

<ul>
<li><a href="https://github.com/oldweather/20CRv3-diagnostics"
           rel="nofollow">Github repository</a></li>
</ul>

<h3>Found a bug, or have a suggestion?</h3>

Please <a href="https://github.com/oldweather/20CRv3-diagnostics/issues/new">raise an issue</a>.
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="validation-spread-v-error-plot-january-1872-spring-1903-february-1953">
<h1>Validation Spread v. Error plot January 1872 + Spring 1903 + February 1953<a class="headerlink" href="#validation-spread-v-error-plot-january-1872-spring-1903-february-1953" title="Permalink to this headline">Â¶</a></h1>
<div class="figure align-center" id="id1" style="width: 95%">
<a class="reference internal image-reference" href="../_images/E_v_E3.png"><img alt="../_images/E_v_E3.png" src="../_images/E_v_E3.png" style="width: 95%;" /></a>
<p class="caption"><span class="caption-text">RMS reanalysis difference from observations, against reanalysis spread. For three reanalyses: 20CR2c in black, 20CR3 in red, and CERA-20C in blue.</span></p>
</div>
<p>The comparison includes data from three months of January to March 1903, augmented by January 1872 (higher spread) and Febriuary 1953 (lower spread).</p>
<p>If the observations were perfect, and the reanalysis spread was an unbiased estimate of its error, the RMS difference and the spread would be the same at all points. Because the observations have error, the RMS difference should be bigger than the spread, especially at small spread: the three grey lines show the expected relationship for three values of observation error (0, 1 and 2hPa). If the points are above the lines, the reanalysis is overconfident (spread too small) - if they are below the lines it is underconfident (spread too large).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>First make the equivalent figure for each period seperately:</p>
<ul class="simple">
<li><a class="reference internal" href="January_1872/comparison.html"><span class="doc">January 1872</span></a></li>
<li><a class="reference internal" href="Spring_1903/comparison.html"><span class="doc">Spring 1903</span></a></li>
<li><a class="reference internal" href="February_1953/comparison.html"><span class="doc">February 1953</span></a></li>
</ul>
<p>Then make the figure</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># Scatter plot of reanalysis spread v reanalysis error</span>
<span class="c1">#  comparing three reanalyses</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_agg</span> <span class="k">import</span> \
                 <span class="n">FigureCanvasAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>

<span class="kn">import</span> <span class="nn">DWR_plots</span>

<span class="n">start</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1871</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">end</span>  <span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1953</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Landscape page</span>
<span class="n">fig</span><span class="o">=</span><span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span>  <span class="c1"># Width, Height (inches)</span>
           <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
           <span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.88</span><span class="p">,</span><span class="mf">0.88</span><span class="p">,</span><span class="mf">0.88</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
           <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
           <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">subplotpars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">tight_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">canvas</span><span class="o">=</span><span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">font</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;family&#39;</span> <span class="p">:</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sans-serif&#39;</span> <span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;weight&#39;</span> <span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span>   <span class="p">:</span> <span class="mi">16</span><span class="p">}</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">font</span><span class="p">)</span>

<span class="c1"># load the data for one reanalysis</span>
<span class="k">def</span> <span class="nf">loadr</span><span class="p">(</span><span class="n">reanalysis</span><span class="p">):</span>
    <span class="n">ddir</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/images/DWR/reanalysis_comparison_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> 
                    <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;SCRATCH&#39;</span><span class="p">),</span><span class="n">reanalysis</span><span class="p">))</span>
    <span class="n">cdata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ensembles&#39;</span><span class="p">:[],</span><span class="s1">&#39;observations&#39;</span><span class="p">:[]}</span>
    <span class="n">dfiles</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">ddir</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dfl</span> <span class="ow">in</span> <span class="n">dfiles</span><span class="p">:</span>
       <span class="n">fdate</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dfl</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">dfl</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]),</span>
                               <span class="nb">int</span><span class="p">(</span><span class="n">dfl</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">dfl</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">]),</span>
                               <span class="nb">int</span><span class="p">(</span><span class="n">dfl</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span><span class="p">]))</span>
       <span class="k">if</span> <span class="n">fdate</span><span class="o">&lt;</span><span class="n">start</span> <span class="ow">or</span> <span class="n">fdate</span> <span class="o">&gt;=</span> <span class="n">end</span><span class="p">:</span> <span class="k">continue</span>
       <span class="n">d_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ddir</span><span class="p">,</span><span class="n">dfl</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
       <span class="n">dpoint</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">d_file</span><span class="p">)</span>
       <span class="n">d_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
       <span class="n">cdata</span><span class="p">[</span><span class="s1">&#39;ensembles&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">cdata</span><span class="p">[</span><span class="s1">&#39;ensembles&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">dpoint</span><span class="p">[</span><span class="s1">&#39;ensembles&#39;</span><span class="p">]</span>
       <span class="n">cdata</span><span class="p">[</span><span class="s1">&#39;observations&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">cdata</span><span class="p">[</span><span class="s1">&#39;observations&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">dpoint</span><span class="p">[</span><span class="s1">&#39;observations&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cdata</span>

<span class="c1"># Fill the frame with an axes</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.89</span><span class="p">,</span><span class="mf">0.89</span><span class="p">])</span>

<span class="n">dmonth</span> <span class="o">=</span> <span class="n">loadr</span><span class="p">(</span><span class="s1">&#39;cera&#39;</span><span class="p">)</span>
<span class="n">DWR_plots</span><span class="o">.</span><span class="n">plot_eve</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dmonth</span><span class="p">,</span><span class="n">point_color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">nbins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">dmonth</span> <span class="o">=</span> <span class="n">loadr</span><span class="p">(</span><span class="s1">&#39;20cr2c&#39;</span><span class="p">)</span>
<span class="n">DWR_plots</span><span class="o">.</span><span class="n">plot_eve</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dmonth</span><span class="p">,</span><span class="n">obs_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">point_color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">nbins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">dmonth</span> <span class="o">=</span> <span class="n">loadr</span><span class="p">(</span><span class="s1">&#39;20cr3&#39;</span><span class="p">)</span>
<span class="n">DWR_plots</span><span class="o">.</span><span class="n">plot_eve</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dmonth</span><span class="p">,</span><span class="n">obs_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">point_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">nbins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>


<span class="c1"># Output as png</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;E_v_E.png&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="../credits.html" title="Authors and acknowledgements"
             >next</a> |</li>
        <li class="right" >
          <a href="February_1953/comparison.html" title="Validation Spread v. Error plot February 1953"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">20CRv3</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>